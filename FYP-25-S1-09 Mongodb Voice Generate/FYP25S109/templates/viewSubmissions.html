{% extends "base.html" %}

{% block content %}
<h2>Submissions for Assignment: {{ assignment.title }}</h2>

<table>
    <tr>
        <th>Student</th>
        <th>File</th>
        <th>Submitted At</th>
        <th>Grade</th>
        <th>Score</th>
        <th>Actions</th>
    </tr>
    {% for submission in submissions %}
    <tr>
        <td>{{ submission.student_username }}</td>
        <td>
            {% if submission.filename and submission.filename != "Not Available" %}
                <a href="{{ url_for('boundary.view_submitted_assignment', filename=submission.filename) }}" target="_blank">View</a>
            {% else %}
                Not Available
            {% endif %}
        </td>
        <td>
            {{ submission.submitted_at.strftime("%Y-%m-%d %H:%M:%S") if submission.submitted_at else "Not Available" }}
        </td>
        <td>
            {% if submission.grade is not none %}
                {{ submission.grade }}
            {% else %}
                Not graded
            {% endif %}
        </td>
        <td>
            {% if submission.grade is not none %}
                {{ submission.grade }} / 100
            {% else %}
                -
            {% endif %}
        </td>
        <td>
            <!-- Grade Form -->
            <form action="{{ url_for('boundary.grade_assignment', classroom_name=classroom_name, assignment_id=assignment._id, student_username=submission.student_username, submission_id=submission._id) }}" method="POST">
                <input type="number" name="grade" min="0" max="100" required>
                <button type="submit">Grade</button>
            </form>

            <!-- Delete Submission Button -->
            <form action="{{ url_for('boundary.delete_submission', submission_id=submission._id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this submission?');">
                <button type="submit" style="background-color: red; color: white;">Delete</button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}



